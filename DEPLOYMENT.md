# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –¥–µ–ø–ª–æ—é

–ü–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è "–ê–ù–û –ü–ë–° –≠–∫–æ—Å–∏—Å—Ç–µ–º–∞ —É—á—ë—Ç–∞" –≤ production –æ–∫—Ä—É–∂–µ–Ω–∏–∏.

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –¥–µ–ø–ª–æ—é](#–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–∫-–¥–µ–ø–ª–æ—é)
- [Frontend –î–µ–ø–ª–æ–π](#frontend-–¥–µ–ø–ª–æ–π)
- [Backend –î–µ–ø–ª–æ–π](#backend-–¥–µ–ø–ª–æ–π)
- [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ MongoDB](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-mongodb)
- [–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å](#–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
- [–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥](#–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥)
- [–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ](#—Ä–µ–∑–µ—Ä–≤–Ω–æ–µ-–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ)

## –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –¥–µ–ø–ª–æ—é

### –ß–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

- [ ] –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç —É—Å–ø–µ—à–Ω–æ
- [ ] –ö–æ–¥ –ø—Ä–æ—à–µ–ª code review
- [ ] –û–±–Ω–æ–≤–ª–µ–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–æ —Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö –≤–µ—Ä—Å–∏–π
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- [ ] –°–æ–∑–¥–∞–Ω –∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω backup –ë–î
- [ ] –ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

**Frontend:**
- Node.js 18+ LTS
- npm 9+

**Backend:**
- Node.js 18+ LTS
- MongoDB 6.0+
- Nginx (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
- SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (Let's Encrypt)

## Frontend –î–µ–ø–ª–æ–π

### –î–µ–ø–ª–æ–π –Ω–∞ Netlify (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

#### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ GitHub

1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∫ Netlify:
   ```bash
   # Netlify –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ netlify.toml
   ```

2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ Netlify Dashboard:
   ```
   VITE_API_URL=https://your-api-domain.com
   VITE_APP_NAME=–ê–ù–û –ü–ë–° –≠–∫–æ—Å–∏—Å—Ç–µ–º–∞ —É—á—ë—Ç–∞
   ```

3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –¥–æ–º–µ–Ω–∞:
   - Settings ‚Üí Domain management ‚Üí Add custom domain
   - –ù–∞—Å—Ç—Ä–æ–π—Ç–µ DNS –∑–∞–ø–∏—Å–∏ —É –≤–∞—à–µ–≥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞

4. SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –Ω–∞—Å—Ç—Ä–æ–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

#### –†—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Netlify CLI
npm install -g netlify-cli

# –õ–æ–≥–∏–Ω –≤ Netlify
netlify login

# –î–µ–ø–ª–æ–π
netlify deploy --prod --dir=dist
```

### –î–µ–ø–ª–æ–π –Ω–∞ Vercel

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Vercel CLI
npm install -g vercel

# –õ–æ–≥–∏–Ω
vercel login

# –î–µ–ø–ª–æ–π
vercel --prod
```

–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ Vercel Dashboard.

### –î–µ–ø–ª–æ–π –Ω–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä

```bash
# 1. –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
npm run build

# 2. –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø–∞–ø–∫–∏ dist –Ω–∞ —Å–µ—Ä–≤–µ—Ä
scp -r dist/* user@your-server:/var/www/html/

# 3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Nginx
```

#### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Nginx –¥–ª—è SPA

```nginx
server {
    listen 80;
    server_name your-domain.com;
    
    # Redirect HTTP to HTTPS
    return 301 https://$server_name$request_uri;
}

server {
    listen 443 ssl http2;
    server_name your-domain.com;
    
    ssl_certificate /etc/letsencrypt/live/your-domain.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/your-domain.com/privkey.pem;
    
    root /var/www/html;
    index index.html;
    
    # Gzip –∫–æ–º–ø—Ä–µ—Å—Å–∏—è
    gzip on;
    gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;
    
    # SPA fallback
    location / {
        try_files $uri $uri/ /index.html;
    }
    
    # Cache —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
}
```

## Backend –î–µ–ø–ª–æ–π

### –î–µ–ø–ª–æ–π –Ω–∞ VPS (Ubuntu/Debian)

#### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

```bash
# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
sudo apt update && sudo apt upgrade -y

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Node.js 18 LTS
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt install -y nodejs

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ MongoDB
wget -qO - https://www.mongodb.org/static/pgp/server-6.0.asc | sudo apt-key add -
echo "deb [ arch=amd64,arm64 ] https://repo.mongodb.org/apt/ubuntu jammy/mongodb-org/6.0 multiverse" | sudo tee /etc/apt/sources.list.d/mongodb-org-6.0.list
sudo apt update
sudo apt install -y mongodb-org

# –ó–∞–ø—É—Å–∫ MongoDB
sudo systemctl start mongod
sudo systemctl enable mongod

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PM2 –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏
sudo npm install -g pm2
```

#### 2. –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
cd /var/www
sudo git clone https://github.com/your-username/anko.git
cd anko/server

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
npm install --production

# –°–æ–∑–¥–∞–Ω–∏–µ .env —Ñ–∞–π–ª–∞
sudo nano .env
```

–ù–∞—Å—Ç—Ä–æ–π—Ç–µ `.env`:
```env
PORT=5000
NODE_ENV=production
MONGODB_URI=mongodb://localhost:27017/accounting_ecosystem
JWT_SECRET=<—Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ —Å–ª–æ–∂–Ω—ã–π –∫–ª—é—á>
CORS_ORIGIN=https://your-frontend-domain.com
```

#### 3. –°–æ–∑–¥–∞–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

```bash
npm run create-admin
```

#### 4. –ó–∞–ø—É—Å–∫ —Å PM2

```bash
# –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
pm2 start server.js --name anko-backend

# –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ —Å–µ—Ä–≤–µ—Ä–∞
pm2 startup
pm2 save

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
pm2 monit
```

#### 5. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Nginx –∫–∞–∫ reverse proxy

```nginx
server {
    listen 80;
    server_name api.your-domain.com;
    return 301 https://$server_name$request_uri;
}

server {
    listen 443 ssl http2;
    server_name api.your-domain.com;
    
    ssl_certificate /etc/letsencrypt/live/api.your-domain.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/api.your-domain.com/privkey.pem;
    
    # –õ–æ–≥–∏
    access_log /var/log/nginx/api.access.log;
    error_log /var/log/nginx/api.error.log;
    
    # Proxy –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
    location / {
        proxy_pass http://localhost:5000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }
    
    # –£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–π timeout –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤
    client_max_body_size 10M;
}
```

### –î–µ–ø–ª–æ–π –Ω–∞ Railway

1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Railway CLI:
```bash
npm install -g @railway/cli
```

2. –õ–æ–≥–∏–Ω –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:
```bash
railway login
cd server
railway init
```

3. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è:
```bash
railway variables set MONGODB_URI=<your-mongodb-uri>
railway variables set JWT_SECRET=<your-secret>
railway variables set CORS_ORIGIN=<your-frontend-url>
```

4. –î–µ–ø–ª–æ–π:
```bash
railway up
```

### –î–µ–ø–ª–æ–π –Ω–∞ Heroku

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Heroku CLI
# https://devcenter.heroku.com/articles/heroku-cli

# –õ–æ–≥–∏–Ω
heroku login

# –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
cd server
heroku create anko-backend

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ MongoDB (MongoDB Atlas)
# –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Atlas –æ—Ç–¥–µ–ª—å–Ω–æ –∏ –ø–æ–ª—É—á–∏—Ç–µ connection string

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
heroku config:set MONGODB_URI=<your-mongodb-uri>
heroku config:set JWT_SECRET=<your-secret>
heroku config:set NODE_ENV=production
heroku config:set CORS_ORIGIN=<your-frontend-url>

# –î–µ–ø–ª–æ–π
git push heroku main
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ MongoDB

### MongoDB Atlas (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è production)

1. –°–æ–∑–¥–∞–π—Ç–µ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –∫–ª–∞—Å—Ç–µ—Ä –Ω–∞ [MongoDB Atlas](https://www.mongodb.com/cloud/atlas)

2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Network Access:
   - –î–æ–±–∞–≤—å—Ç–µ IP –∞–¥—Ä–µ—Å –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
   - –ò–ª–∏ —Ä–∞–∑—Ä–µ—à–∏—Ç–µ –¥–æ—Å—Ç—É–ø —Å–æ –≤—Å–µ—Ö IP (0.0.0.0/0) —Å —Å–∏–ª—å–Ω—ã–º –ø–∞—Ä–æ–ª–µ–º

3. –°–æ–∑–¥–∞–π—Ç–µ Database User —Å –ø—Ä–∞–≤–∞–º–∏ readWrite

4. –ü–æ–ª—É—á–∏—Ç–µ connection string:
   ```
   mongodb+srv://username:password@cluster.mongodb.net/accounting_ecosystem?retryWrites=true&w=majority
   ```

5. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤ `.env`:
   ```env
   MONGODB_URI=mongodb+srv://username:password@cluster.mongodb.net/accounting_ecosystem?retryWrites=true&w=majority
   ```

### –õ–æ–∫–∞–ª—å–Ω—ã–π MongoDB –Ω–∞ VPS

```bash
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
mongo

use admin
db.createUser({
  user: "admin",
  pwd: "secure_password",
  roles: ["root"]
})

use accounting_ecosystem
db.createUser({
  user: "app_user",
  pwd: "app_password",
  roles: [{ role: "readWrite", db: "accounting_ecosystem" }]
})
exit

# –í–∫–ª—é—á–µ–Ω–∏–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
sudo nano /etc/mongod.conf
```

–î–æ–±–∞–≤—å—Ç–µ –≤ `mongod.conf`:
```yaml
security:
  authorization: enabled
```

```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ MongoDB
sudo systemctl restart mongod

# Connection string
MONGODB_URI=mongodb://app_user:app_password@localhost:27017/accounting_ecosystem
```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

#### 1. –°–∏–ª—å–Ω—ã–µ —Å–µ–∫—Ä–µ—Ç—ã JWT

```bash
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –∫–ª—é—á–∞
node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
```

#### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Firewall (UFW –Ω–∞ Ubuntu)

```bash
# –†–∞–∑—Ä–µ—à–∏—Ç—å SSH
sudo ufw allow 22

# –†–∞–∑—Ä–µ—à–∏—Ç—å HTTP/HTTPS
sudo ufw allow 80
sudo ufw allow 443

# –ó–∞–∫—Ä—ã—Ç—å MongoDB –æ—Ç –≤–Ω–µ—à–Ω–µ–≥–æ –¥–æ—Å—Ç—É–ø–∞
sudo ufw deny 27017

# –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å firewall
sudo ufw enable
```

#### 3. SSL/TLS —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (Let's Encrypt)

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Certbot
sudo apt install certbot python3-certbot-nginx

# –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
sudo certbot --nginx -d your-domain.com -d api.your-domain.com

# –ê–≤—Ç–æ-–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
sudo certbot renew --dry-run
```

#### 4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
npm audit

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
npm audit fix

# –í production –æ–∫—Ä—É–∂–µ–Ω–∏–∏
npm ci
```

#### 5. Rate Limiting

–ù–∞—Å—Ç—Ä–æ–µ–Ω–æ –≤ `server/middleware/rateLimiter.js`. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
- –õ–æ–≥–∏–Ω: 5 –ø–æ–ø—ã—Ç–æ–∫ –∑–∞ 15 –º–∏–Ω—É—Ç
- API –∑–∞–ø—Ä–æ—Å—ã: 100 –∑–∞–ø—Ä–æ—Å–æ–≤ –∑–∞ 15 –º–∏–Ω—É—Ç

#### 6. CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `CORS_ORIGIN` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –¥–æ–º–µ–Ω:
```env
CORS_ORIGIN=https://your-frontend-domain.com
```

–ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `*` –≤ production!

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### PM2 –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

```bash
# –°—Ç–∞—Ç—É—Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
pm2 status

# –õ–æ–≥–∏
pm2 logs anko-backend

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å–æ–≤
pm2 monit

# –ü—Ä–æ—Å–º–æ—Ç—Ä –º–µ—Ç—Ä–∏–∫
pm2 show anko-backend
```

### –°–∏—Å—Ç–µ–º–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

```bash
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞
df -h

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏
free -h

# CPU –∏ –ø—Ä–æ—Ü–µ—Å—Å—ã
top

# MongoDB —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
mongo --eval "db.serverStatus()"
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

PM2 –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç –ª–æ–≥–∞–º–∏. –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:
```
~/.pm2/logs/anko-backend-out.log  # stdout
~/.pm2/logs/anko-backend-error.log  # stderr
```

–†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤:
```bash
pm2 install pm2-logrotate
pm2 set pm2-logrotate:max_size 10M
pm2 set pm2-logrotate:retain 7
```

## –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π backup MongoDB

–°–æ–∑–¥–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç `backup.sh`:

```bash
#!/bin/bash
DATE=$(date +%Y%m%d_%H%M%S)
BACKUP_DIR="/var/backups/mongodb"
DB_NAME="accounting_ecosystem"

# –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
mkdir -p $BACKUP_DIR

# Backup
mongodump --db $DB_NAME --out $BACKUP_DIR/$DATE

# –°–∂–∞—Ç–∏–µ
tar -czf $BACKUP_DIR/$DATE.tar.gz -C $BACKUP_DIR $DATE
rm -rf $BACKUP_DIR/$DATE

# –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –±—ç–∫–∞–ø–æ–≤ (—Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π)
find $BACKUP_DIR -name "*.tar.gz" -mtime +30 -delete

echo "Backup completed: $BACKUP_DIR/$DATE.tar.gz"
```

–ù–∞—Å—Ç—Ä–æ–π–∫–∞ cron:
```bash
# –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ crontab
crontab -e

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ backup –≤ 2:00
0 2 * * * /path/to/backup.sh >> /var/log/mongodb-backup.log 2>&1
```

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ backup

```bash
# –†–∞—Å–ø–∞–∫–æ–≤–∫–∞
tar -xzf backup_20260211_020000.tar.gz

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
mongorestore --db accounting_ecosystem backup_20260211_020000/accounting_ecosystem
```

## –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –°—Ç—Ä–∞—Ç–µ–≥–∏—è Zero-Downtime

```bash
# 1. Backup –ë–î
./backup.sh

# 2. –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏
cd /var/www/anko
git fetch origin
git checkout main
git pull origin main

# 3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
cd server
npm install --production

# 4. –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å graceful reload
pm2 reload anko-backend

# 5. –ü—Ä–æ–≤–µ—Ä–∫–∞
pm2 logs anko-backend --lines 50
```

### Rollback –≤ —Å–ª—É—á–∞–µ –ø—Ä–æ–±–ª–µ–º

```bash
# –û—Ç–∫–∞—Ç –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏
git reset --hard HEAD~1

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
npm ci

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
pm2 reload anko-backend
```

## Troubleshooting

### –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –∫ –ë–î

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ MongoDB
sudo systemctl status mongod

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ MongoDB
sudo tail -f /var/log/mongodb/mongod.log

# –¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
mongo "mongodb://localhost:27017/accounting_ecosystem"
```

### –í—ã—Å–æ–∫–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏

```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º –ø–∞–º—è—Ç–∏
pm2 delete anko-backend
pm2 start server.js --name anko-backend --max-memory-restart 500M
```

### –ü—Ä–æ–±–ª–µ–º—ã —Å SSL

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
sudo certbot certificates

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
sudo certbot renew

# –¢–µ—Å—Ç SSL –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
sudo nginx -t
```

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# PM2
pm2 restart anko-backend     # –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
pm2 stop anko-backend        # –û—Å—Ç–∞–Ω–æ–≤–∫–∞
pm2 delete anko-backend      # –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑ PM2
pm2 logs --lines 100         # –ü–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å—Ç—Ä–æ–∫ –ª–æ–≥–æ–≤

# Nginx
sudo nginx -t                # –¢–µ—Å—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
sudo systemctl reload nginx  # –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
sudo systemctl restart nginx # –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫

# MongoDB
sudo systemctl restart mongod
mongo --eval "db.stats()"

# –ü—Ä–æ—Å–º–æ—Ç—Ä –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
netstat -tulpn | grep LISTEN
```

## –ö–æ–Ω—Ç–∞–∫—Ç—ã –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º —Å –¥–µ–ø–ª–æ–µ–º:
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `pm2 logs`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è: `pm2 env 0`
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: [README.md](./README.md)
- –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ MongoDB: [server/MIGRATION.md](./server/MIGRATION.md)

---

**–í–∞–∂–Ω–æ:** –ü–µ—Ä–µ–¥ production –¥–µ–ø–ª–æ–µ–º –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≤—Å—ë –≤ staging –æ–∫—Ä—É–∂–µ–Ω–∏–∏!
