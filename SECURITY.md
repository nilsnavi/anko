# –ü–æ–ª–∏—Ç–∏–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

## –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –≤–µ—Ä—Å–∏–∏

–ú—ã –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö –≤–µ—Ä—Å–∏–π –ø—Ä–æ–µ–∫—Ç–∞:

| –í–µ—Ä—Å–∏—è | –ü–æ–¥–¥–µ—Ä–∂–∫–∞         |
| ------ | ----------------- |
| 1.x.x  | :white_check_mark: |
| < 1.0  | :x:                |

## –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—è–∑–≤–∏–º–æ—Å—Ç–∏

–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –Ω–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –∏ –Ω–∞—à–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π - –Ω–∞—à –≥–ª–∞–≤–Ω—ã–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç. –ï—Å–ª–∏ –≤—ã –æ–±–Ω–∞—Ä—É–∂–∏–ª–∏ —É—è–∑–≤–∏–º–æ—Å—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, **–Ω–µ —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π issue**.

### –ö–∞–∫ —Å–æ–æ–±—â–∏—Ç—å –æ–± —É—è–∑–≤–∏–º–æ—Å—Ç–∏

1. **Email**: –û—Ç–ø—Ä–∞–≤—å—Ç–µ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ `security@ecosystem-pbs.ru`
2. **–í–∫–ª—é—á–∏—Ç–µ**:
   - –¢–∏–ø —É—è–∑–≤–∏–º–æ—Å—Ç–∏
   - –ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Å —à–∞–≥–∞–º–∏ –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
   - –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ
   - –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–µ—Å–ª–∏ –µ—Å—Ç—å)

### –ß—Ç–æ –æ–∂–∏–¥–∞—Ç—å

- **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ** –≤ —Ç–µ—á–µ–Ω–∏–µ 48 —á–∞—Å–æ–≤
- **–û—Ü–µ–Ω–∫–∞** —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ 7 –¥–Ω–µ–π
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –≤ —Ç–µ—á–µ–Ω–∏–µ 14 –¥–Ω–µ–π
- **–ü—É–±–ª–∏–∫–∞—Ü–∏—è** –ø–∞—Ç—á–∞ –∏ advisory –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Ä–∞—Å–∫—Ä—ã—Ç–∏–µ

- –î–∞–π—Ç–µ –Ω–∞–º —Ä–∞–∑—É–º–Ω–æ–µ –≤—Ä–µ–º—è –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ –ø—É–±–ª–∏—á–Ω–æ–≥–æ —Ä–∞—Å–∫—Ä—ã—Ç–∏—è
- –ü—Ä–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ —É–ø–æ–º—è–Ω–∏—Ç–µ –Ω–∞—Å (@nilsnavi)
- –ú—ã —É–ø–æ–º—è–Ω–µ–º –≤–∞—Å –≤ credits (–µ—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ)

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

#### 1. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

**‚úó –ü–ª–æ—Ö–æ:**
```env
JWT_SECRET=secret123
MONGODB_URI=mongodb://admin:admin@localhost/db
```

**‚úì –•–æ—Ä–æ—à–æ:**
```env
JWT_SECRET=8f7a3b2e9d1c4a5f6b8e7d9c2a1b3e4f5a6b7c8d9e0f1a2b3c4d5e6f7a8b9c0d
MONGODB_URI=mongodb://strong_user:Str0ng_P@ssw0rd_Here@localhost/db
```

–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –∫–ª—é—á–∞:
```bash
node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
```

#### 2. –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –∏ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
npm audit

# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
npm audit fix

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
npm update
```

#### 3. –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ bcrypt —Å –º–∏–Ω–∏–º—É–º 10 —Ä–∞—É–Ω–¥–∞–º–∏ –¥–ª—è –ø–∞—Ä–æ–ª–µ–π
- –•—Ä–∞–Ω–∏—Ç–µ JWT –≤ httpOnly cookies (–Ω–µ –≤ localStorage)
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ refresh —Ç–æ–∫–µ–Ω—ã
- –†–µ–∞–ª–∏–∑—É–π—Ç–µ rate limiting –¥–ª—è –ª–æ–≥–∏–Ω–∞

#### 4. –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

–í—Å–µ–≥–¥–∞ –≤–∞–ª–∏–¥–∏—Ä—É–π—Ç–µ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:

```javascript
// Backend
const { body, validationResult } = require('express-validator');

app.post('/api/users', [
  body('email').isEmail().normalizeEmail(),
  body('password').isLength({ min: 8 }),
], (req, res) => {
  const errors = validationResult(req);
  if (!errors.isEmpty()) {
    return res.status(400).json({ errors: errors.array() });
  }
  // ...
});
```

#### 5. CORS

–í production –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –¥–æ–º–µ–Ω—ã:

```javascript
// ‚úó –ü–ª–æ—Ö–æ
app.use(cors({ origin: '*' }));

// ‚úì –•–æ—Ä–æ—à–æ
app.use(cors({ 
  origin: process.env.CORS_ORIGIN || 'https://your-domain.com',
  credentials: true 
}));
```

#### 6. –ó–∞—â–∏—Ç–∞ headers (Helmet)

```javascript
const helmet = require('helmet');
app.use(helmet());
```

#### 7. Rate Limiting

```javascript
const rateLimit = require('express-rate-limit');

const limiter = rateLimit({
  windowMs: 15 * 60 * 1000, // 15 –º–∏–Ω—É—Ç
  max: 100 // –º–∞–∫—Å–∏–º—É–º 100 –∑–∞–ø—Ä–æ—Å–æ–≤
});

app.use('/api/', limiter);
```

### –î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤

#### 1. MongoDB

**–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:**
```bash
# –°–æ–∑–¥–∞–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏
use accounting_ecosystem
db.createUser({
  user: "app_user",
  pwd: "strong_password",
  roles: [{ role: "readWrite", db: "accounting_ecosystem" }]
})
```

**Firewall:**
```bash
# –ó–∞–∫—Ä–æ–π—Ç–µ MongoDB –æ—Ç –≤–Ω–µ—à–Ω–µ–≥–æ –¥–æ—Å—Ç—É–ø–∞
sudo ufw deny 27017
```

#### 2. HTTPS/SSL

–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS –≤ production:

**Nginx:**
```nginx
server {
    listen 443 ssl http2;
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ SSL –ø—Ä–æ—Ç–æ–∫–æ–ª—ã
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers HIGH:!aNULL:!MD5;
    
    # HSTS
    add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
}
```

#### 3. Firewall

```bash
# –ë–∞–∑–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ UFW
sudo ufw default deny incoming
sudo ufw default allow outgoing
sudo ufw allow ssh
sudo ufw allow 80
sudo ufw allow 443
sudo ufw enable
```

#### 4. –û–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã

```bash
# –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
sudo apt update
sudo apt upgrade -y
sudo apt autoremove -y
```

#### 5. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:

```javascript
// Winston logging
const winston = require('winston');

const logger = winston.createLogger({
  level: 'info',
  format: winston.format.json(),
  transports: [
    new winston.transports.File({ filename: 'error.log', level: 'error' }),
    new winston.transports.File({ filename: 'combined.log' })
  ]
});

// –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
app.use((req, res, next) => {
  logger.info(`${req.method} ${req.url}`, {
    ip: req.ip,
    userId: req.user?.id
  });
  next();
});
```

#### 6. Backup

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π backup MongoDB:

```bash
#!/bin/bash
# backup.sh
mongodump --db accounting_ecosystem --out /backup/$(date +%Y%m%d)
find /backup -type d -mtime +30 -exec rm -rf {} \;
```

Cron:
```bash
0 2 * * * /path/to/backup.sh
```

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

#### 1. –ü–∞—Ä–æ–ª–∏

- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø–∞—Ä–æ–ª–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
- –ú–∏–Ω–∏–º—É–º 12 —Å–∏–º–≤–æ–ª–æ–≤
- –ö–æ–º–±–∏–Ω–∞—Ü–∏—è –±—É–∫–≤, —Ü–∏—Ñ—Ä –∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ–Ω–µ–¥–∂–µ—Ä –ø–∞—Ä–æ–ª–µ–π

#### 2. –î–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

–í–∫–ª—é—á–∏—Ç–µ 2FA –≤–µ–∑–¥–µ, –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ (GitHub, –æ–±–ª–∞—á–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã, etc.)

#### 3. –û–±–Ω–æ–≤–ª–µ–Ω–∏—è

- –û–±–Ω–æ–≤–ª—è–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä
- –û–±–Ω–æ–≤–ª—è–π—Ç–µ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É
- –°–ª–µ–¥–∏—Ç–µ –∑–∞ security advisories –ø—Ä–æ–µ–∫—Ç–∞

## –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –†–µ—à–µ–Ω–Ω—ã–µ

| CVE ID | –û–ø–∏—Å–∞–Ω–∏–µ | –ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ –≤–µ—Ä—Å–∏–∏ | –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ |
|--------|----------|-------------------|--------------|
| -      | -        | -                 | -            |

### –í –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–µ—à–µ–Ω–∏—è

| Issue ID | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | ETA |
|----------|----------|-----------|-----|
| -        | -        | -         | -   |

## Security Checklist –¥–ª—è Production

–ü–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º –≤ production —É–±–µ–¥–∏—Ç–µ—Å—å:

### Backend

- [ ] `NODE_ENV=production` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- [ ] JWT_SECRET - —Å–ª–æ–∂–Ω—ã–π —Å–ª—É—á–∞–π–Ω—ã–π –∫–ª—é—á (32+ —Å–∏–º–≤–æ–ª–∞)
- [ ] MongoDB –∏–º–µ–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é
- [ ] MongoDB –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑–≤–Ω–µ (firewall)
- [ ] CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –¥–æ–º–µ–Ω—ã
- [ ] Rate limiting –≤–∫–ª—é—á–µ–Ω
- [ ] Helmet middleware –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
- [ ] HTTPS/SSL –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ
- [ ] Backup –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] Error handling –Ω–µ —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç sensitive –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
- [ ] –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã (`npm audit`)

### Frontend

- [ ] API calls –∏—Å–ø–æ–ª—å–∑—É—é—Ç HTTPS
- [ ] Sensitive –¥–∞–Ω–Ω—ã–µ –Ω–µ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ console
- [ ] –ù–µ—Ç hardcoded credentials
- [ ] Environment variables –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- [ ] Build –º–∏–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω
- [ ] Source maps –æ—Ç–∫–ª—é—á–µ–Ω—ã –≤ production

### Infrastructure

- [ ] Firewall –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] SSH –¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –ø–æ –∫–ª—é—á–∞–º
- [ ] Root login –æ—Ç–∫–ª—é—á–µ–Ω
- [ ] –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- [ ] Backup –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω
- [ ] Disaster recovery –ø–ª–∞–Ω —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

## –†–µ—Å—É—Ä—Å—ã

- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [Node.js Security Best Practices](https://nodejs.org/en/docs/guides/security/)
- [Express Security Best Practices](https://expressjs.com/en/advanced/best-practice-security.html)
- [MongoDB Security Checklist](https://docs.mongodb.com/manual/administration/security-checklist/)

## –ö–æ–Ω—Ç–∞–∫—Ç—ã

- **Email**: security@ecosystem-pbs.ru
- **GitHub**: [@nilsnavi](https://github.com/nilsnavi)

---

**–°–ø–∞—Å–∏–±–æ –∑–∞ –ø–æ–º–æ—â—å –≤ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞!** üîí
